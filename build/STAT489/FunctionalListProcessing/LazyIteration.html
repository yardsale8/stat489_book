<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>7.7. Lazy Iteration &mdash; Runestone Interactive Overview</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/clickable.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="../_static/modal-basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/datafile.css" type="text/css" />
    <link rel="stylesheet" href="../_static/dragndrop.css" type="text/css" />
    <link rel="stylesheet" href="../_static/fitb.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/livecode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/parsons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/poll.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tabbedstuff.css" type="text/css" />
    <link rel="stylesheet" href="../_static/video.css" type="text/css" />
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/""/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="../_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/runestonebase.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="../_static/bookfuncs.js"></script>
    <script type="text/javascript" src="../_static/codemirror.js"></script>
    <script type="text/javascript" src="../_static/xml.js"></script>
    <script type="text/javascript" src="../_static/css.js"></script>
    <script type="text/javascript" src="../_static/htmlmixed.js"></script>
    <script type="text/javascript" src="../_static/python.js"></script>
    <script type="text/javascript" src="../_static/javascript.js"></script>
    <script type="text/javascript" src="../_static/activecode.js"></script>
    <script type="text/javascript" src="../_static/skulpt.min.js"></script>
    <script type="text/javascript" src="../_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="../_static/clike.js"></script>
    <script type="text/javascript" src="../_static/timed_activecode.js"></script>
    <script type="text/javascript" src="../_static/animationbase.js"></script>
    <script type="text/javascript" src="../_static/mchoice.js"></script>
    <script type="text/javascript" src="../_static/timedmc.js"></script>
    <script type="text/javascript" src="../_static/timed.js"></script>
    <script type="text/javascript" src="../_static/clickable.js"></script>
    <script type="text/javascript" src="../_static/timedclickable.js"></script>
    <script type="text/javascript" src="../_static/d3.v2.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="../_static/pytutor.js"></script>
    <script type="text/javascript" src="../_static/codelens.js"></script>
    <script type="text/javascript" src="../_static/skulpt.min.js"></script>
    <script type="text/javascript" src="../_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="../_static/datafile.js"></script>
    <script type="text/javascript" src="../_static/dragndrop.js"></script>
    <script type="text/javascript" src="../_static/timeddnd.js"></script>
    <script type="text/javascript" src="../_static/fitb.js"></script>
    <script type="text/javascript" src="../_static/timedfitb.js"></script>
    <script type="text/javascript" src="../_static/livecode.js"></script>
    <script type="text/javascript" src="../_static/clike.js"></script>
    <script type="text/javascript" src="../_static/lib/prettify.js"></script>
    <script type="text/javascript" src="../_static/lib/hammer.min.js"></script>
    <script type="text/javascript" src="../_static/parsons.js"></script>
    <script type="text/javascript" src="../_static/timedparsons.js"></script>
    <script type="text/javascript" src="../_static/poll.js"></script>
    <script type="text/javascript" src="../_static/reveal.js"></script>
    <script type="text/javascript" src="../_static/shortanswer.js"></script>
    <script type="text/javascript" src="../_static/timed_shortanswer.js"></script>
    <script type="text/javascript" src="../_static/tabbedstuff.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="../_static/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="../_static/waypoints.min.js"></script>
    <script type="text/javascript" src="../_static/rangy-core.js"></script>
    <script type="text/javascript" src="../_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="../_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="../_static/user-highlights.js"></script>
    <script type="text/javascript" src="../_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="../_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.hotkey.js"></script>
    <script type="text/javascript" src="../_static/jquery-migrate-1.2.1.min.js"></script>
    <link rel="top" title="Runestone Interactive Overview" href="../index.html" />
    <link rel="up" title="7. Functional List Processing" href="toctree.html" />
    <link rel="next" title="7.8. Recursive Generator Functions" href="RecursiveGeneratorFunctions.html" />
    <link rel="prev" title="7.6. Common Patterns for Processing Sequences with Dictionaries" href="CommonPatternsForProcessingSequencesWithDictionaries.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/runestone/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'http://127.0.0.1:8000' ? 'http://127.0.0.1:8000' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/runestone';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'STAT489';
  eBookConfig.logLevel = 0;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.isLoggedIn = false;
  eBookConfig.useRunestoneServices = false;
  eBookConfig.python3 = true;
  eBookConfig.basecourse = 'STAT489';
</script>

<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>



  </head>
  <body role="document">


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='background: transparent url("../_static/img/logo_small.png") no-repeat 0px 0px;' href="/runestone/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="../index.html">STAT489</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- social media dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-share-alt" style="opacity: 0.9"></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="true">Follow @iRunestone</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                <div class="fb-like" data-href="https://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="300" data-show-faces="false" data-font="arial"></div>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li>
        <!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html'>Table of Contents</a></li>
            
            <li><a href='/runestone/static/STAT489/genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        
        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='/runestone/static/STAT489/navhelp.html'>Navigation Help</a></li>
            <li><a href='/runestone/static/overview/instructor.html'>Help for Instructors</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='/runestone/default/reportabug?course=STAT489&page=LazyIteration'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">7.7. Lazy Iteration</a><ul>
<li><a class="reference internal" href="#generator-expressions">7.7.1. Generator Expressions</a></li>
<li><a class="reference internal" href="#the-advantage-of-lazy-sequence-evaluation">7.7.2. The advantage of lazy sequence evaluation</a></li>
<li><a class="reference internal" href="#more-complicated-generator-expressions">7.7.3. More Complicated Generator Expressions</a></li>
<li><a class="reference internal" href="#generator-functions">7.7.4. Generator Functions</a><ul>
<li><a class="reference internal" href="#the-yield-statement">7.7.4.1. The <code class="docutils literal"><span class="pre">yield</span></code> statement</a></li>
<li><a class="reference internal" href="#the-yield-from-statement">7.7.4.2. The <code class="docutils literal"><span class="pre">yield</span> <span class="pre">from</span></code> statement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coroutines">7.7.5. Coroutines</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - 7.6. Common Patterns for Processing Sequences with Dictionaries" data-toggle="tooltip">
    <a href="CommonPatternsForProcessingSequencesWithDictionaries.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - 7.8. Recursive Generator Functions' data-toggle="tooltip" >
    <a href="RecursiveGeneratorFunctions.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="lazy-iteration">
<h1>7.7. Lazy Iteration<a class="headerlink" href="#lazy-iteration" title="Permalink to this headline">¶</a></h1>
<p>We have already seen some Python expressions that exhibit lazy evaluation,
including <code class="docutils literal"><span class="pre">range</span></code>, <code class="docutils literal"><span class="pre">map</span></code> and <code class="docutils literal"><span class="pre">filter</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gh">Out[1]: </span><span class="go">range(0, 4)</span>

<span class="gp">In [2]: </span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="go">                    Out[2]: &lt;map at 0x1100c01d0&gt;</span>

<span class="gp">In [3]: </span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="go">                                                 Out[3]: &lt;filter at 0x1100c0828&gt;</span>
</pre></div>
</div>
<p>Each of these object will hold off evaluation as long as possible.  In this
section, we will show you other methods for constructing your own lazy
constructs and discuss the advantage of chaining together lazy expressions.</p>
<div class="section" id="generator-expressions">
<h2>7.7.1. Generator Expressions<a class="headerlink" href="#generator-expressions" title="Permalink to this headline">¶</a></h2>
<p>The core lazy type in Python is the <em>generator</em>.  The easiest way to construct a
lazy expression is using the <strong>generator expression</strong>, which has the same syntax
as a list comprehension, except that it is surrounded by parentheses.</p>
<div class="figure">
<img alt="The generator expression" src="../_images/generator_expression.png" />
<div class="legend">
The syntax for the generator function is the same as that of a list
comprehension, except being delimited by parentheses.  The resulting object will
hold off computing each item until evaluation is forced.</div>
</div>
<p>For a first example, let&#8217;s write the generator expression of squaring all of the
odd values in a sequence.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [4]: </span><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">In [5]: </span><span class="n">g</span>
<span class="gh">Out[5]: </span><span class="go">&lt;generator object &lt;genexpr&gt; at 0x10ff6a0a0&gt;</span>
</pre></div>
</div>
<p>Notice that evaluating the generator doesn&#8217;t produce the sequence.  We can force
the evaluation of the next item in the sequence using the <code class="docutils literal"><span class="pre">next</span></code> function.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [6]: </span><span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gh">Out[6]: </span><span class="go">1</span>

<span class="gp">In [7]: </span><span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">          Out[7]: 9</span>

<span class="gp">In [8]: </span><span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">                    ---------------------------------------------------------------------------</span>
<span class="go">StopIteration                             Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-8-5f315c5de15b&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 next(g)</span>

<span class="go">StopIteration: </span>
</pre></div>
</div>
<p>By design, the generator will throw an exception when it has completed the
sequence, which can be caught by a <code class="docutils literal"><span class="pre">try-except</span></code> block to determine the end of
the sequence.  In practice, this exception does not surface, as we process
generators in loops, comprehensions, or other lazy constructs like <code class="docutils literal"><span class="pre">map</span></code> and
<code class="docutils literal"><span class="pre">filter</span></code>.  Each of these techniques catches the termination exception behind
the scenes so that our code can successfully complete.</p>
<p>Note that a generator is a <strong>single-use sequence</strong> and must be reinitialized
before attempting to iterate a second time.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [9]: </span><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">In [10]: </span><span class="n">g</span>
<span class="gh">Out[10]: </span><span class="go">&lt;generator object &lt;genexpr&gt; at 0x10cfa5410&gt;</span>

<span class="gp">In [11]: </span><span class="n">x</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="gp">In [12]: </span><span class="n">x</span>
<span class="gh">Out[12]: </span><span class="go">[1, 9]</span>

<span class="gp">In [13]: </span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="gp">In [14]: </span><span class="n">y</span>
<span class="gh">Out[14]: </span><span class="go">[]</span>

<span class="gp">In [15]: </span><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">item</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">if</span> <span class="n">item</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">In [16]: </span><span class="n">z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="gp">In [17]: </span><span class="n">z</span>
<span class="gh">Out[17]: </span><span class="go">[1, 9]</span>
</pre></div>
</div>
</div>
<div class="section" id="the-advantage-of-lazy-sequence-evaluation">
<h2>7.7.2. The advantage of lazy sequence evaluation<a class="headerlink" href="#the-advantage-of-lazy-sequence-evaluation" title="Permalink to this headline">¶</a></h2>
<p>The primary advantage of using generator expressions to process sequences comes
from the fact that chaining together generators preserves the lazy evaluation.
For example, suppose that we want to compute the distance to some point
<span class="math">\((a, b)\)</span> for a series of points.  One way to approach this problem is to
attack it in a series of small operations.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [18]: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="gp">In [19]: </span><span class="n">points</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>  <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)])</span>

<span class="gp">In [20]: </span><span class="n">dist_along_axes</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">points</span><span class="p">)</span>

<span class="gp">In [21]: </span><span class="n">sum_sqr_dist</span> <span class="o">=</span> <span class="p">(</span> <span class="n">d1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d2</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="ow">in</span> <span class="n">dist_along_axes</span><span class="p">)</span>

<span class="gp">In [22]: </span><span class="n">dist_to_ab</span> <span class="o">=</span> <span class="p">(</span> <span class="n">sqr_dist</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">sqr_dist</span> <span class="ow">in</span> <span class="n">sum_sqr_dist</span><span class="p">)</span>

<span class="gp">In [23]: </span><span class="nb">next</span><span class="p">(</span><span class="n">dist_to_ab</span><span class="p">)</span>
<span class="gh">Out[23]: </span><span class="go">5.830951894845301</span>

<span class="gp">In [24]: </span><span class="nb">next</span><span class="p">(</span><span class="n">dist_to_ab</span><span class="p">)</span>
<span class="go">                           Out[24]: 4.47213595499958</span>

<span class="gp">In [25]: </span><span class="nb">next</span><span class="p">(</span><span class="n">dist_to_ab</span><span class="p">)</span>
<span class="go">                                                     Out[25]: 3.1622776601683795</span>
</pre></div>
</div>
<p>Under casual inspection, it will appear that we have iterated over the points 4
times, one for each comprehension.  <strong>The key feature to note is that each call
to next gives the complete solution for that point without forcing the
computation for the next point. This is true regardless of how many generators
we chain together!</strong> In reality these data are all processed
exactly once, as each sequence is lazy and waits to complete each calculation
until the last moment.  Consequently, the chain of generators will each compute
the next value and pass it along in sequence.  This is a very powerful <em>and
efficient</em> approach to composing operations on sequences.</p>
<p>Contrast this with a solution that uses list comprehensions.  Each comprehension
is <em>eager</em> to complete its operation and this will result in the sequence being
iterated over once for each comprehension.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [26]: </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="gp">In [27]: </span><span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span>  <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]]</span>

<span class="gp">In [28]: </span><span class="n">points</span>
<span class="gh">Out[28]: </span><span class="go">[(0, 0), (1, 1), (2, 2)]</span>

<span class="gp">In [29]: </span><span class="n">dist_along_axes</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>

<span class="gp">In [30]: </span><span class="n">dist_along_axes</span>
<span class="gh">Out[30]: </span><span class="go">[(-3, -5), (-2, -4), (-1, -3)]</span>

<span class="gp">In [31]: </span><span class="n">sum_sqr_dist</span> <span class="o">=</span> <span class="p">[</span><span class="n">d1</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">d2</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span> <span class="ow">in</span> <span class="n">dist_along_axes</span><span class="p">]</span>

<span class="gp">In [32]: </span><span class="n">sum_sqr_dist</span>
<span class="gh">Out[32]: </span><span class="go">[34, 20, 10]</span>

<span class="gp">In [33]: </span><span class="n">dist_to_ab</span> <span class="o">=</span> <span class="p">[</span><span class="n">sqr_dist</span><span class="o">**</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="k">for</span> <span class="n">sqr_dist</span> <span class="ow">in</span> <span class="n">sum_sqr_dist</span><span class="p">]</span>

<span class="gp">In [34]: </span><span class="n">dist_to_ab</span>
<span class="gh">Out[34]: </span><span class="go">[5.830951894845301, 4.47213595499958, 3.1622776601683795]</span>
</pre></div>
</div>
<p>In constrast to the solution that used generators, the last batch of code
illustrates that each comprehension has completed it&#8217;s computation before the
next operation.  Consequently each point is visited 4 times, as opposed to once
for the lazy approach.</p>
<p>The main drawback of the eager approach is that it requires we keep the each
list in memory, which is lead to a decline in performance as list get large.  In
fact, &#8220;Big Data&#8221; problems typically involve more data than can be held in the
memory of any one machine.  Using lazy evaluation gives the first solution to
this problem by allowing use to process the data incrementally without ever
needing all of it in memory at one time.</p>
</div>
<div class="section" id="more-complicated-generator-expressions">
<h2>7.7.3. More Complicated Generator Expressions<a class="headerlink" href="#more-complicated-generator-expressions" title="Permalink to this headline">¶</a></h2>
<p>All of the tricks that you learned about list comprehensions will work with
generator expressions as well, be it nesting list comprehensions or including
multiple sequence expression.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="gp">In [36]: </span><span class="n">g</span>
<span class="gh">Out[36]: </span><span class="go">&lt;generator object &lt;genexpr&gt; at 0x1100522b0&gt;</span>

<span class="gp">In [37]: </span><span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">                                                     Out[37]: [0, 0, 0, 0, 0, 1, 2, 3, 4, 4, 6, 8, 9, 12, 16]</span>
</pre></div>
</div>
<p>The only caveat is that next generators are <strong>very lazy</strong> and can be difficult
to force to completion.  In this next example, this is accomplished by
mapping the <code class="docutils literal"><span class="pre">list</span></code> conversion function unto each embedded lazy sequence.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [38]: </span><span class="n">g</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="gp">In [39]: </span><span class="n">table</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>

<span class="gp">In [40]: </span><span class="n">table</span>
<span class="gh">Out[40]: </span><span class="go"></span>
<span class="go">[&lt;generator object &lt;genexpr&gt;.&lt;genexpr&gt; at 0x110052e08&gt;,</span>
<span class="go"> &lt;generator object &lt;genexpr&gt;.&lt;genexpr&gt; at 0x110052db0&gt;,</span>
<span class="go"> &lt;generator object &lt;genexpr&gt;.&lt;genexpr&gt; at 0x110052d00&gt;,</span>
<span class="go"> &lt;generator object &lt;genexpr&gt;.&lt;genexpr&gt; at 0x110052c50&gt;,</span>
<span class="go"> &lt;generator object &lt;genexpr&gt;.&lt;genexpr&gt; at 0x110052888&gt;]</span>

<span class="gp">In [41]: </span><span class="n">mapped_table</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">table</span><span class="p">))</span>

<span class="gp">In [42]: </span><span class="n">mapped_table</span>
<span class="gh">Out[42]: </span><span class="go"></span>
<span class="go">[[0, 4, 8, 12, 16],</span>
<span class="go"> [0, 4, 8, 12, 16],</span>
<span class="go"> [0, 4, 8, 12, 16],</span>
<span class="go"> [0, 4, 8, 12, 16],</span>
<span class="go"> [0, 4, 8, 12, 16]]</span>

<span class="gp">In [43]: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[[</span><span class="n">i</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

<span class="gp">In [44]: </span><span class="n">L</span>
<span class="gh">Out[44]: </span><span class="go"></span>
<span class="go">[[0, 0, 0, 0, 0],</span>
<span class="go"> [0, 1, 2, 3, 4],</span>
<span class="go"> [0, 2, 4, 6, 8],</span>
<span class="go"> [0, 3, 6, 9, 12],</span>
<span class="go"> [0, 4, 8, 12, 16]]</span>
</pre></div>
</div>
<p><strong>That answer is wrong! (or at least unexpected)</strong>  In the last attempt, I
messed up by completing the outer generator without completing the inner
loops.  Therefore the value of <code class="docutils literal"><span class="pre">i</span></code> was stuck at the last generated value.
The correct way to resolve this nested structure is to process all the
sequences simulaneously as follows.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [45]: </span><span class="n">g</span> <span class="o">=</span> <span class="p">((</span><span class="n">i</span><span class="o">*</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="gp">In [46]: </span><span class="n">mapped_table</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span>

<span class="gp">In [47]: </span><span class="n">mapped_table</span>
<span class="gh">Out[47]: </span><span class="go"></span>
<span class="go">[[0, 0, 0, 0, 0],</span>
<span class="go"> [0, 1, 2, 3, 4],</span>
<span class="go"> [0, 2, 4, 6, 8],</span>
<span class="go"> [0, 3, 6, 9, 12],</span>
<span class="go"> [0, 4, 8, 12, 16]]</span>
</pre></div>
</div>
<p><strong>Main Takeaway:</strong> Processing nested, single-use lazy structures can be
tricky and return unexpected results depending on the order of execution.</p>
</div>
<div class="section" id="generator-functions">
<h2>7.7.4. Generator Functions<a class="headerlink" href="#generator-functions" title="Permalink to this headline">¶</a></h2>
<p>A more robust method of creating generators is using the <code class="docutils literal"><span class="pre">yield</span></code> and/or
<code class="docutils literal"><span class="pre">yield</span> <span class="pre">from</span></code> statements in a function definition.</p>
<div class="section" id="the-yield-statement">
<h3>7.7.4.1. The <code class="docutils literal"><span class="pre">yield</span></code> statement<a class="headerlink" href="#the-yield-statement" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal"><span class="pre">yield</span></code> statement is used to yield the next value in the lazy sequence and
tells Python that our function is really a generator.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [48]: </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="sd">&quot;&quot;&quot; a function &quot;&quot;&quot;</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">   ....: </span>

<span class="gp">In [49]: </span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="sd">&quot;&quot;&quot; A generator &quot;&quot;&quot;</span>
<span class="gp">   ....: </span>    <span class="k">yield</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>When we call a regular function like <code class="docutils literal"><span class="pre">f</span></code>, the value is result is immediately
returned.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="nb">type</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="gh">Out[50]: </span><span class="go">function</span>

<span class="gp">In [51]: </span><span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [52]: </span><span class="n">y</span>
<span class="gh">Out[52]: </span><span class="go">4</span>
</pre></div>
</div>
<p>On the other hand, a call to a generator will yield a lazy generator object that
requires a call to <code class="docutils literal"><span class="pre">next</span></code> before it will return a value.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [53]: </span><span class="nb">type</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gh">Out[53]: </span><span class="go">function</span>

<span class="gp">In [54]: </span><span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [55]: </span><span class="n">y</span>
<span class="gh">Out[55]: </span><span class="go">&lt;generator object g at 0x10d1108e0&gt;</span>

<span class="gp">In [56]: </span><span class="nb">next</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">                                             Out[56]: 4</span>
</pre></div>
</div>
<p>Generators can include any number of <code class="docutils literal"><span class="pre">yield</span></code> statements and will halt
execution at each statement, waiting for a request for the <code class="docutils literal"><span class="pre">next</span></code> value.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [57]: </span><span class="k">def</span> <span class="nf">many_yields</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="sd">&quot;&quot;&quot; a generator with multiple yield statements &quot;&quot;&quot;</span>
<span class="gp">   ....: </span>    <span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">   ....: </span>    <span class="k">yield</span> <span class="n">y</span>
<span class="gp">   ....: </span>    <span class="n">z</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">   ....: </span>    <span class="k">yield</span> <span class="n">z</span>
<span class="gp">   ....: </span>    <span class="k">yield</span> <span class="s2">&quot;Awesome&quot;</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [58]: </span><span class="n">g</span> <span class="o">=</span> <span class="n">many_yields</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="gp">In [59]: </span><span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="gh">Out[59]: </span><span class="go">4</span>

<span class="gp">In [60]: </span><span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">           Out[60]: 6</span>

<span class="gp">In [61]: </span><span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">                      Out[61]: &#39;Awesome&#39;</span>

<span class="gp">In [62]: </span><span class="nb">next</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="go">                                         ---------------------------------------------------------------------------</span>
<span class="go">StopIteration                             Traceback (most recent call last)</span>
<span class="go">&lt;ipython-input-62-5f315c5de15b&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 next(g)</span>

<span class="go">StopIteration: </span>
</pre></div>
</div>
<p>Notice that the generator captures and maintains the start of the body inbetween
calls to next.  For example, <code class="docutils literal"><span class="pre">many_yields</span></code> kept the value of <code class="docutils literal"><span class="pre">y</span></code> so that it
could be later used to compute <code class="docutils literal"><span class="pre">z</span></code>.  As with generator expressions, any
<code class="docutils literal"><span class="pre">next</span></code> calls beyond the last <code class="docutils literal"><span class="pre">yield</span></code> will throw an exception.</p>
<p>Finally, note that we can use comprehensions (list or generator) to process a
generator.  In this case, Python takes care of catching the <code class="docutils literal"><span class="pre">StopIteration</span></code>
exception.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [63]: </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">many_yields</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
<span class="gh">Out[63]: </span><span class="go">[4, 6, &#39;Awesome&#39;]</span>
</pre></div>
</div>
</div>
<div class="section" id="the-yield-from-statement">
<h3>7.7.4.2. The <code class="docutils literal"><span class="pre">yield</span> <span class="pre">from</span></code> statement<a class="headerlink" href="#the-yield-from-statement" title="Permalink to this headline">¶</a></h3>
<p>Sometimes we want to yield values from some other sequence.  In this case, we
can use the <code class="docutils literal"><span class="pre">yield</span> <span class="pre">from</span></code> statement, which automates the process of iterating
through the sequence, yielding one item at a time in a lazy fashion.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [64]: </span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="k">yield from</span> <span class="n">L</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [65]: </span><span class="n">y</span> <span class="o">=</span> <span class="n">g</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>

<span class="gp">In [66]: </span><span class="n">y</span>
<span class="gh">Out[66]: </span><span class="go">&lt;generator object g at 0x10d110570&gt;</span>

<span class="gp">In [67]: </span><span class="nb">type</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">                                             Out[67]: generator</span>

<span class="gp">In [68]: </span><span class="nb">next</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">                                                                Out[68]: 1</span>

<span class="gp">In [69]: </span><span class="nb">next</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">                                                                           Out[69]: 2</span>

<span class="gp">In [70]: </span><span class="nb">next</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">                                                                                      Out[70]: 3</span>
</pre></div>
</div>
<p>You can combine any combination of <code class="docutils literal"><span class="pre">yield</span></code> and <code class="docutils literal"><span class="pre">yield</span> <span class="pre">from</span></code> statements.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [71]: </span><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="k">yield</span> <span class="s2">&quot;Wait for it&quot;</span>
<span class="gp">   ....: </span>    <span class="k">yield</span> <span class="s2">&quot;Here it comes...&quot;</span>
<span class="gp">   ....: </span>    <span class="k">yield</span> <span class="s2">&quot;...any second now...&quot;</span>
<span class="gp">   ....: </span>    <span class="k">yield from</span> <span class="n">L</span>
<span class="gp">   ....: </span>    <span class="k">yield</span> <span class="s2">&quot;So there you go&quot;</span>
<span class="gp">   ....: </span>    <span class="k">yield</span> <span class="s2">&quot;Enjoy!&quot;</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [72]: </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">g</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])]</span>
<span class="gh">Out[72]: </span><span class="go"></span>
<span class="go">[&#39;Wait for it&#39;,</span>
<span class="go"> &#39;Here it comes...&#39;,</span>
<span class="go"> &#39;...any second now...&#39;,</span>
<span class="go"> 1,</span>
<span class="go"> 2,</span>
<span class="go"> 3,</span>
<span class="go"> &#39;So there you go&#39;,</span>
<span class="go"> &#39;Enjoy!&#39;]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Generator expressions also can used a <code class="docutils literal"><span class="pre">return</span></code> statement, but this
immediately throws a <code class="docutils literal"><span class="pre">StopIteration</span></code> exception.  The main purpose of this
statement in a generator is to control when a generated sequence halts.
We will show how this can be used to speed up a recursively defined
generator in the next section.</p>
</div>
</div>
</div>
<div class="section" id="coroutines">
<h2>7.7.5. Coroutines<a class="headerlink" href="#coroutines" title="Permalink to this headline">¶</a></h2>
<p>Generators are a form of one-way lazy evaluation. Once created they only return
items and can no longer receive values.  Python has another lazy structure that
can be used to pass values back and forth in a lazy way: a <strong>coroutine</strong>.</p>
<p>The keyword <code class="docutils literal"><span class="pre">yield</span></code> is again used to create a coroutine, but this time using
it in an assignment-like statement.  This assignment statement signifies both
the yielding of the next value and acquisition of the next value.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [73]: </span><span class="k">def</span> <span class="nf">coroutine</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="gp">   ....: </span>    <span class="n">s</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">s</span>
<span class="gp">   ....: </span>    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="gp">   ....: </span>    <span class="n">s</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">s</span>
<span class="gp">   ....: </span>    <span class="n">s</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="n">s</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
<span class="gp">   ....: </span>    <span class="n">s</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">s</span>
<span class="gp">   ....: </span>
</pre></div>
</div>
<p>As with generators, values are pulled from a coroutine using <code class="docutils literal"><span class="pre">next</span></code>.  A
coroutine comes with a method <code class="docutils literal"><span class="pre">send</span></code> that is used to pass it the next value.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [74]: </span><span class="n">co</span> <span class="o">=</span> <span class="n">coroutine</span><span class="p">(</span><span class="s2">&quot;Hi &quot;</span><span class="p">)</span>

<span class="gp">In [75]: </span><span class="nb">next</span><span class="p">(</span><span class="n">co</span><span class="p">)</span>
<span class="gh">Out[75]: </span><span class="go">&#39;hi &#39;</span>

<span class="gp">In [76]: </span><span class="n">co</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;there &quot;</span><span class="p">)</span>
<span class="go">               Out[76]: &#39;there &#39;</span>

<span class="gp">In [77]: </span><span class="n">co</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;Bob!&quot;</span><span class="p">)</span>
<span class="go">                                 Out[77]: &#39;BOB!BOB!BOB!&#39;</span>
</pre></div>
</div>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - 7.6. Common Patterns for Processing Sequences with Dictionaries' data-toggle="tooltip">
    <a href="CommonPatternsForProcessingSequencesWithDictionaries.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="CommonPatternsForProcessingSequencesWithDictionaries.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - 7.8. Recursive Generator Functions' data-toggle="tooltip" >
    <a href="RecursiveGeneratorFunctions.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="RecursiveGeneratorFunctions.html" >Next Section - 7.8. Recursive Generator Functions</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017 Todd Iverson.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
    </p>
  </div>
</footer>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32029811-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>