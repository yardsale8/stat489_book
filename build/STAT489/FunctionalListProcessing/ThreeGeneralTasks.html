<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>7.3. Three General Tasks &mdash; Runestone Interactive Overview</title>
    
    <link rel="stylesheet" href="../_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/clickable.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="../_static/modal-basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/datafile.css" type="text/css" />
    <link rel="stylesheet" href="../_static/dragndrop.css" type="text/css" />
    <link rel="stylesheet" href="../_static/fitb.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/livecode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/parsons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/poll.css" type="text/css" />
    <link rel="stylesheet" href="../_static/tabbedstuff.css" type="text/css" />
    <link rel="stylesheet" href="../_static/video.css" type="text/css" />
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootswatch/2.3.1/""/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/jquery-ui-1.10.3.custom.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/user-highlights.css" type="text/css" />
    <link rel="stylesheet" href="../_static/runestone-custom-sphinx-bootstrap.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/runestonebase.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="../_static/bookfuncs.js"></script>
    <script type="text/javascript" src="../_static/codemirror.js"></script>
    <script type="text/javascript" src="../_static/xml.js"></script>
    <script type="text/javascript" src="../_static/css.js"></script>
    <script type="text/javascript" src="../_static/htmlmixed.js"></script>
    <script type="text/javascript" src="../_static/python.js"></script>
    <script type="text/javascript" src="../_static/javascript.js"></script>
    <script type="text/javascript" src="../_static/activecode.js"></script>
    <script type="text/javascript" src="../_static/skulpt.min.js"></script>
    <script type="text/javascript" src="../_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="../_static/clike.js"></script>
    <script type="text/javascript" src="../_static/timed_activecode.js"></script>
    <script type="text/javascript" src="../_static/animationbase.js"></script>
    <script type="text/javascript" src="../_static/mchoice.js"></script>
    <script type="text/javascript" src="../_static/timedmc.js"></script>
    <script type="text/javascript" src="../_static/timed.js"></script>
    <script type="text/javascript" src="../_static/clickable.js"></script>
    <script type="text/javascript" src="../_static/timedclickable.js"></script>
    <script type="text/javascript" src="../_static/d3.v2.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="../_static/pytutor.js"></script>
    <script type="text/javascript" src="../_static/codelens.js"></script>
    <script type="text/javascript" src="../_static/skulpt.min.js"></script>
    <script type="text/javascript" src="../_static/skulpt-stdlib.js"></script>
    <script type="text/javascript" src="../_static/datafile.js"></script>
    <script type="text/javascript" src="../_static/dragndrop.js"></script>
    <script type="text/javascript" src="../_static/timeddnd.js"></script>
    <script type="text/javascript" src="../_static/fitb.js"></script>
    <script type="text/javascript" src="../_static/timedfitb.js"></script>
    <script type="text/javascript" src="../_static/livecode.js"></script>
    <script type="text/javascript" src="../_static/clike.js"></script>
    <script type="text/javascript" src="../_static/lib/prettify.js"></script>
    <script type="text/javascript" src="../_static/lib/hammer.min.js"></script>
    <script type="text/javascript" src="../_static/parsons.js"></script>
    <script type="text/javascript" src="../_static/timedparsons.js"></script>
    <script type="text/javascript" src="../_static/poll.js"></script>
    <script type="text/javascript" src="../_static/reveal.js"></script>
    <script type="text/javascript" src="../_static/shortanswer.js"></script>
    <script type="text/javascript" src="../_static/timed_shortanswer.js"></script>
    <script type="text/javascript" src="../_static/tabbedstuff.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/jquery-ui-1.10.3.custom.min.js"></script>
    <script type="text/javascript" src="../_static/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <script type="text/javascript" src="../_static/waypoints.min.js"></script>
    <script type="text/javascript" src="../_static/rangy-core.js"></script>
    <script type="text/javascript" src="../_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="../_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="../_static/user-highlights.js"></script>
    <script type="text/javascript" src="../_static/jquery.idle-timer.js"></script>
    <script type="text/javascript" src="../_static/processing-1.4.1.min.js"></script>
    <script type="text/javascript" src="../_static/jquery.hotkey.js"></script>
    <script type="text/javascript" src="../_static/jquery-migrate-1.2.1.min.js"></script>
    <link rel="top" title="Runestone Interactive Overview" href="../index.html" />
    <link rel="up" title="7. Functional List Processing" href="toctree.html" />
    <link rel="next" title="7.4. What are Higher Order Functions?" href="WhatAreHigherOrderFunctions.html" />
    <link rel="prev" title="7.1. More Details About Python Functions" href="MoreAboutPythonFunctions.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
<link rel="shortcut icon" href="/runestone/static/favicon.ico" type="image/ico" />

<script type="text/javascript">
  eBookConfig = {};
  eBookConfig.host = 'http://127.0.0.1:8000' ? 'http://127.0.0.1:8000' : 'http://127.0.0.1:8000';
  eBookConfig.app = eBookConfig.host+'/runestone';
  eBookConfig.ajaxURL = eBookConfig.app+'/ajax/';
  eBookConfig.course = 'STAT489';
  eBookConfig.logLevel = 0;
  eBookConfig.loginRequired = false;
  eBookConfig.build_info = "unknown";
  eBookConfig.isLoggedIn = false;
  eBookConfig.useRunestoneServices = false;
  eBookConfig.python3 = true;
  eBookConfig.basecourse = 'STAT489';
</script>

<div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&status=0";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>



  </head>
  <body role="document">


<!-- Begin navbar -->
<div id="navbar" class="navbar navbar-default navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
      <button type='button' class='navbar-toggle' data-toggle="collapse" data-target=".navbar-ex1-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div>
        <a class="brand-logo" style='background: transparent url("../_static/img/logo_small.png") no-repeat 0px 0px;' href="/runestone/default/user/login">&nbsp; </a>
        <a class="navbar-brand" href="../index.html">STAT489</a>
      </div>
    </div>

    <div class="navbar-collapse collapse navbar-ex1-collapse">

      <ul class="nav navbar-nav navbar-right">

        <li class="divider-vertical"></li>

        <!-- social media dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-share-alt" style="opacity: 0.9"></i>
          </a>
          <ul class="dropdown-menu social-menu">
              <li>
                <div>
                  <b>Runestone in social media:</b>
                </div>
                <a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="true">Follow @iRunestone</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                <div class="fb-like" data-href="https://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="300" data-show-faces="false" data-font="arial"></div>
              </li>

              <li class="divider"></li>
              <li>
                <div>
                  <b>Help support us:</b>
                </div>
                <div>
                    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
                  <input type="hidden" name="cmd" value="_s-xclick">
                  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHNwYJKoZIhvcNAQcEoIIHKDCCByQCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYAcrkqh1hn3lYqIpfXxNqe1T82EhXzCJGy1yMAmklpyZshyMkfDGe1Bhx+iwyGeoYRTTyphFmP+9M3NyO0+Q5XdHxgZPx/zYjjBxlZHgEV6jhE8bN2fHkkPf0VHfz0a0QQylQOPlKiOTZV7B37Jpk6yM47oVZ1tG/KNm0NkfmB76DELMAkGBSsOAwIaBQAwgbQGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIi0GmFfOlcjuAgZBbYOo9UO+CpMQa+PYqwsUmUnJvXIImeMeNI3KVTUx5Cfk9gNMo3WzPeiB5IqZo9nRAQ0mf1qL2ecLeB5tidM+lgBUhOxfj3/FecpnVFa0263gp4g+PLw8jzhvVRdUon1K3SeO1Rzh23fIRKwnrD6btt73uwtj0sl3tGd8qz+6GIcwPDdRk9VcUffiBJT/ZagKgggOHMIIDgzCCAuygAwIBAgIBADANBgkqhkiG9w0BAQUFADCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wHhcNMDQwMjEzMTAxMzE1WhcNMzUwMjEzMTAxMzE1WjCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAMFHTt38RMxLXJyO2SmS+Ndl72T7oKJ4u4uw+6awntALWh03PewmIJuzbALScsTS4sZoS1fKciBGoh11gIfHzylvkdNe/hJl66/RGqrj5rFb08sAABNTzDTiqqNpJeBsYs/c2aiGozptX2RlnBktH+SUNpAajW724Nv2Wvhif6sFAgMBAAGjge4wgeswHQYDVR0OBBYEFJaffLvGbxe9WT9S1wob7BDWZJRrMIG7BgNVHSMEgbMwgbCAFJaffLvGbxe9WT9S1wob7BDWZJRroYGUpIGRMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbYIBADAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4GBAIFfOlaagFrl71+jq6OKidbWFSE+Q4FqROvdgIONth+8kSK//Y/4ihuE4Ymvzn5ceE3S/iBSQQMjyvb+s2TWbQYDwcp129OPIbD9epdr4tJOUNiSojw7BHwYRiPh58S1xGlFgHFXwrEBb3dgNbMUa+u4qectsMAXpVHnD9wIyfmHMYIBmjCCAZYCAQEwgZQwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tAgEAMAkGBSsOAwIaBQCgXTAYBgkqhkiG9w0BCQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0xMzExMDMxMzQxMzFaMCMGCSqGSIb3DQEJBDEWBBRDJF8w+zsMr7FSk+pwinB5f5D4rzANBgkqhkiG9w0BAQEFAASBgHw1LMHpkpaqHIvDGdFE0eG+2mZlmMnUeDCBhQlbc7QMzFQYKTV94NfaebBO4PmNdADe1rq4WidSRZZbE7CzkX9IGENYnBTWY0hb2l0lGdGrJdGeWyV3ekg9WVaFMMumrekds96h3Cx7dGz2kWDzIai2iEXE/qoE+xpkyXAYZNV3-----END PKCS7-----
                  ">
                  <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                  <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
                  </form>

                </div>
              </li>
          </ul>
        </li>
        <!-- end social media dropdown -->

        <li class="divider-vertical"></li>

        <!-- search dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-search" style='opacity:0.9;'></i>
          </a>
          <ul class='dropdown-menu'>
            
                <li><a href='../index.html'>Table of Contents</a></li>
            
            <li><a href='/runestone/static/STAT489/genindex.html'>Book Index</a></li>
            <li class="divider"></li>
            <li id="scratch_ac_link"><a href="javascript:ACFactory.toggleScratchActivecode()">Scratch ActiveCode</a></li>
            <li class="divider"></li>
            <li style="width: 240px;">
              <form class="navbar-search" style="margin:10px;" action="../search.html" method="get">
                <div class="input-group">
                  <input type="text" class="form-control" name="q" placeholder="Search this book" />
                  <span class="input-group-btn">
                    <button class="btn btn-primary" style="margin:0;" type="submit">
                      <i class="glyphicon glyphicon-search"></i>
                    </button>
                  </span>
                </div><!-- /input-group -->
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
            </li>
          </ul>
        </li>
        <!-- end search dropdown -->

        <li class="divider-vertical"></li>

        
        <li class="divider-vertical"></li>

        <!-- help menu dropdown -->
        <li class="dropdown">
          <a class="dropdown-toggle" href="#" data-toggle="dropdown">
            <i class="glyphicon glyphicon-question-sign" style="opacity:0.9;"></i>
          </a>
          <ul class="dropdown-menu user-menu">
            <li><a href='/runestone/static/STAT489/navhelp.html'>Navigation Help</a></li>
            <li><a href='/runestone/static/overview/instructor.html'>Help for Instructors</a></li>
            <li class="divider"></li>
            <li><a href='http://runestoneinteractive.org'>About Runestone</a></li>
            <li><a href='/runestone/default/reportabug?course=STAT489&page=ThreeGeneralTasks'>Report A Problem</a></li>
          </ul>
        </li>
        <!-- end help menu dropdown -->

        <li class="divider-vertical"></li>

      </ul>

      <ul class="nav navbar-nav">
        <li class="divider-vertical"></li>
        <!--
          <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">7.3. Three General Tasks</a><ul>
<li><a class="reference internal" href="#map">7.3.1. Map</a></li>
<li><a class="reference internal" href="#filter">7.3.2. Filter</a></li>
<li><a class="reference internal" href="#reduce">7.3.3. Reduce</a></li>
<li><a class="reference internal" href="#simultaneous-reductions">7.3.4. Simultaneous Reductions</a></li>
</ul>
</li>
</ul>
</ul>
</li>
          <li class="divider-vertical"></li>
        
        
          
  <li id="relations-prev" title="Previous Chapter - 7.1. More Details About Python Functions" data-toggle="tooltip">
    <a href="MoreAboutPythonFunctions.html" >
      <i class='glyphicon glyphicon-backward' style='opacity:0.9;'></i>
    </a>
  </li>
  
  <li id="relations-next" title='Next Chapter - 7.4. What are Higher Order Functions?' data-toggle="tooltip" >
    <a href="WhatAreHigherOrderFunctions.html" >
      <i class='glyphicon glyphicon-forward' style='opacity:0.9;'></i>
    </a>
  </li>
  <li class="divider-vertical"></li>

<script type="text/javascript">
  opts = {'placement':'bottom',
          'selector': '',
          'delay': { show: 100, hide: 50}
         };

  $('#relations-prev').tooltip(opts);
  $('#relations-next').tooltip(opts);
</script>
        -->
        
          <li></li>
        
      </ul>

    </div>
  </div>
</div>


<div class="container" id="continue-reading"></div>

<div class="container" id="main-content">
  
  <div class="section" id="three-general-tasks">
<h1>7.3. Three General Tasks<a class="headerlink" href="#three-general-tasks" title="Permalink to this headline">¶</a></h1>
<p>When processing a sequence of data, problems can frequency be solved using a
combination of three general operations: <em>map</em>, <em>filter</em> and <em>reduce</em>.  Many of
the examples from Chapter 4 can be framed in this light.</p>
<div class="section" id="map">
<h2>7.3.1. Map<a class="headerlink" href="#map" title="Permalink to this headline">¶</a></h2>
<p>A <strong>map</strong> is the operation of applying or <em>mapping</em> a function to each element
of a list.  An example would be squaring all the elements in a list.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [1]: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [2]: </span><span class="n">sqr</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">In [3]: </span><span class="n">sqr_L</span> <span class="o">=</span> <span class="p">[</span><span class="n">sqr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>

<span class="gp">In [4]: </span><span class="n">sqr_L</span>
<span class="gh">Out[4]: </span><span class="go">[1, 4, 9, 16, 25]</span>
</pre></div>
</div>
<p>In fact, the form of applying a map with a list comprehension will always have
the following form shown below for some function <code class="docutils literal"><span class="pre">f</span></code>.</p>
<p><strong>General Form of a map</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mapped_L</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>
</pre></div>
</div>
<div class="figure">
<img alt="Mapping the sqr function onto a list." src="../_images/map_sqr_list.png" />
<div class="legend">
The function <code class="docutils literal"><span class="pre">map</span></code> applies <code class="docutils literal"><span class="pre">sqr</span></code> (first argument) to each element of the list (second argument).</div>
</div>
<p>Since this is a common functional pattern, we should construct a general
abstraction.  For this expression, we would want to be able to change the
function <code class="docutils literal"><span class="pre">f</span></code> being mapped and the list <code class="docutils literal"><span class="pre">L</span></code>.  The following definition gives
an abstraction for <code class="docutils literal"><span class="pre">map</span></code> (titled <code class="docutils literal"><span class="pre">my_map</span></code> to avoid shadowing the built-in
<code class="docutils literal"><span class="pre">map</span></code>).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [5]: </span><span class="n">my_map</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">func</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">L</span><span class="p">]</span>

<span class="gp">In [6]: </span><span class="n">my_map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gh">Out[6]: </span><span class="go">[0, 1, 4, 9, 16]</span>
</pre></div>
</div>
<p>In the above example, the first argument of <code class="docutils literal"><span class="pre">my_map</span></code> is the function (lambda
expression) that will be applied to each element and the second argument is the
sequence to be processed.  Python has a built-in function <code class="docutils literal"><span class="pre">map</span></code> that
generalizes this process.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [7]: </span><span class="n">out</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="gp">In [8]: </span><span class="n">out</span>
<span class="gh">Out[8]: </span><span class="go">&lt;map at 0x1117cef98&gt;</span>

<span class="gp">In [9]: </span><span class="nb">type</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="go">                             Out[9]: map</span>

<span class="gp">In [10]: </span><span class="nb">list</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="go">                                         Out[10]: [0, 1, 4, 9, 16]</span>

<span class="gp">In [11]: </span><span class="n">out</span>
<span class="go">                                                                   Out[11]: &lt;map at 0x1117cef98&gt;</span>

<span class="go"># out has been processed and is now empty</span>
<span class="gp">In [12]: </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">out</span><span class="p">]</span>
<span class="go">                                                                                                 Out[12]: []</span>

<span class="go"># We need to reinitialize out to process a second time.</span>
<span class="gp">In [13]: </span><span class="n">out</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>

<span class="gp">In [14]: </span><span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">out</span><span class="p">]</span>
<span class="gh">Out[14]: </span><span class="go">[0, 1, 4, 9, 16]</span>
</pre></div>
</div>
<p>Like the <code class="docutils literal"><span class="pre">range</span></code> function, <code class="docutils literal"><span class="pre">map</span></code> is <em>lazy</em> and must be forced to complete
evaluation using the <code class="docutils literal"><span class="pre">list</span></code> conversion function or another list comprehension.
<strong>It should also be noted that a map can only be processed once.</strong>  If we want
to process a map a second time, it will need to be re-initialized as shown
above.</p>
<p><strong>Check your understanding</strong></p>

            <ul data-component="multiplechoice" data-multipleanswers="false"  id="map_1">
            <p>exceptions-4-8: What will out evaluate to for the following code?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">has_vowel</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">any</span><span class="p">([</span><span class="bp">True</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="s1">&#39;aeiou&#39;</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">has_vowel</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>
</div>

            <li data-component="answer" data-correct id="map_1_opt_a">(A) A lazy object</li><li data-component="feedback" id="map_1_opt_a">The built-in map function is lazy and will return a generator object unless completion is forced by list/comprehension/reduce</li>
            
            <li data-component="answer"  id="map_1_opt_b">(B) [True, False, False]</li><li data-component="feedback" id="map_1_opt_b">The built-in map function is lazy and will return a generator object unless completion is forced by list/comprehension/reduce</li>
            
            <li data-component="answer"  id="map_1_opt_c">(C) ['a']</li><li data-component="feedback" id="map_1_opt_c">The built-in map function is lazy and will return a generator object unless completion is forced by list/comprehension/reduce</li>
            
            <li data-component="answer"  id="map_1_opt_d">(D) Error, you can't use a function as an argument for another function.</li><li data-component="feedback" id="map_1_opt_d">Functions are "first class citizens" in Python, meaning they can be used in the same way as any other piece of data</li>
            

            </ul>
            
            <ul data-component="multiplechoice" data-multipleanswers="false"  id="map_2">
            <p>exceptions-4-9: What will out evaluate to for the following code?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">has_vowel</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">any</span><span class="p">([</span><span class="bp">True</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="s1">&#39;aeiou&#39;</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">has_vowel</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]))</span>
</pre></div>
</div>

            <li data-component="answer"  id="map_2_opt_a">(A) A lazy object</li><li data-component="feedback" id="map_2_opt_a">Applying the list conversion function to map will force completion of the lazy generator object returned by map.</li>
            
            <li data-component="answer" data-correct id="map_2_opt_b">(B) [True, False, False]</li><li data-component="feedback" id="map_2_opt_b">Map will apply has_vowel to each letter in the list, keeping the resulting Boolean value.</li>
            
            <li data-component="answer"  id="map_2_opt_c">(C) ['a']</li><li data-component="feedback" id="map_2_opt_c">This would be the result of filter.  Map will apply has_vowel to each letter in the list, keeping the resulting Boolean value.</li>
            
            <li data-component="answer"  id="map_2_opt_d">(D) Error, you can't use a function as an argument for another function.</li><li data-component="feedback" id="map_2_opt_d">Functions are "first class citizens" in Python, meaning they can be used in the same way as any other piece of data</li>
            

            </ul>
            
            <ul data-component="multiplechoice" data-multipleanswers="false"  id="map_3">
            <p>exceptions-4-10: Which of the following functions can be used to replace has_vowel?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">has_vowel</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">any</span><span class="p">([</span><span class="bp">True</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="s1">&#39;aeiou&#39;</span><span class="p">])</span>
</pre></div>
</div>

            <li data-component="answer" data-correct id="map_3_opt_a">(A) lambda L: any(map(lambda ch: ch.lower() in 'aeiou', L))</li><li data-component="feedback" id="map_3_opt_a">Map will check if each character is a vowel and any will return True if there is at least on vowel in the list.</li>
            
            <li data-component="answer"  id="map_3_opt_b">(B) lambda L: all(map(lambda ch: ch.lower() in 'aeiou', L))</li><li data-component="feedback" id="map_3_opt_b">Map will check if each character is a vowel but all would only return True if ALL of the characters in the list are vowels.</li>
            

            </ul>
            </div>
<div class="section" id="filter">
<h2>7.3.2. Filter<a class="headerlink" href="#filter" title="Permalink to this headline">¶</a></h2>
<p>A <strong>filter</strong> is the operation of <em>filtering</em> the list to only include values
that fit some condition.  For example, we would filter out all of the odd number
from a list of numbers.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [15]: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [16]: </span><span class="n">is_odd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>

<span class="gp">In [17]: </span><span class="n">odd_L</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">is_odd</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>

<span class="gp">In [18]: </span><span class="n">odd_L</span>
<span class="gh">Out[18]: </span><span class="go">[1, 3, 5]</span>
</pre></div>
</div>
<p>Once again, the basic form of a filter is easy to express in the form of a list
comprehension.  Let <code class="docutils literal"><span class="pre">predicate</span></code> be a Boolean function that checks the
condition by which we filter.  Then a filter operation can be expressed as
follows.</p>
<p><strong>General form of a filter</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">filtered_L</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">predicate</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</pre></div>
</div>
<div class="figure">
<img alt="Filter a list on odd values." src="../_images/filter_odd_list.png" />
<div class="legend">
When applying <code class="docutils literal"><span class="pre">filter</span></code> with <code class="docutils literal"><span class="pre">is_odd</span></code> (first argument) to the list
<code class="docutils literal"><span class="pre">[1,2,3,4,5]</span></code> (second argument), all of the values where <code class="docutils literal"><span class="pre">is_odd</span></code>
returns <code class="docutils literal"><span class="pre">True</span></code> are retained.</div>
</div>
<p>As with <code class="docutils literal"><span class="pre">map</span></code>, we can easily create an abstraction of this pattern.  In this
case, we want to be able to change the predicate function as well as the list
being processed.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [19]: </span><span class="n">my_filter</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pred</span><span class="p">,</span> <span class="n">L</span><span class="p">:</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">pred</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>

<span class="gp">In [20]: </span><span class="n">my_filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="gh">Out[20]: </span><span class="go">[1, 3, 5]</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">my_filter</span></code> will iterate though all of the elements of the second argument
<code class="docutils literal"><span class="pre">range(1,6)</span></code>, applying <code class="docutils literal"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">x</span> <span class="pre">%</span> <span class="pre">2</span> <span class="pre">==</span> <span class="pre">1</span></code> and only keeping the values
which return true.  Python also comes with a built-in, lazy implementation of
<code class="docutils literal"><span class="pre">filter</span></code>.  As with <code class="docutils literal"><span class="pre">map</span></code>, we need to force completion of this process using
the <code class="docutils literal"><span class="pre">list</span></code> conversion function or another list comprehension and the filter
object will be empty after being processed.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [21]: </span><span class="n">out</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="gp">In [22]: </span><span class="n">out</span>
<span class="gh">Out[22]: </span><span class="go">&lt;filter at 0x1117c6320&gt;</span>

<span class="gp">In [23]: </span><span class="nb">type</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="go">                                 Out[23]: filter</span>

<span class="gp">In [24]: </span><span class="nb">list</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="go">                                                 Out[24]: [1, 3, 5]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You will probably be initially annoyed at the laziness of <code class="docutils literal"><span class="pre">map</span></code> and
<code class="docutils literal"><span class="pre">filter</span></code>, but there is a very good reason for this feature.   We will
discuss this advantage in an upcoming section on lazy evaluation in Python.</p>
</div>
<p><strong>Check your understanding</strong></p>

            <ul data-component="multiplechoice" data-multipleanswers="false"  id="filter_1">
            <p>exceptions-4-11: What will out evaluate to for the following code?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">has_vowel</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">any</span><span class="p">([</span><span class="bp">True</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="s1">&#39;aeiou&#39;</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">has_vowel</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">])</span>
</pre></div>
</div>

            <li data-component="answer" data-correct id="filter_1_opt_a">(A) A lazy object</li><li data-component="feedback" id="filter_1_opt_a">The built-in filter function is lazy and will return a generator object unless completion is forced by list/comprehension/reduce</li>
            
            <li data-component="answer"  id="filter_1_opt_b">(B) [True, False, False]</li><li data-component="feedback" id="filter_1_opt_b">The built-in filter function is lazy and will return a generator object unless completion is forced by list/comprehension/reduce</li>
            
            <li data-component="answer"  id="filter_1_opt_c">(C) ['a']</li><li data-component="feedback" id="filter_1_opt_c">The built-in filter function is lazy and will return a generator object unless completion is forced by list/comprehension/reduce</li>
            
            <li data-component="answer"  id="filter_1_opt_d">(D) Error, you can't use a function as an argument for another function.</li><li data-component="feedback" id="filter_1_opt_d">Functions are "first class citizens" in Python, meaning they can be used in the same way as any other piece of data</li>
            

            </ul>
            
            <ul data-component="multiplechoice" data-multipleanswers="false"  id="filter_2">
            <p>exceptions-4-12: What will out evaluate to for the following code?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">has_vowel</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">any</span><span class="p">([</span><span class="bp">True</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">ch</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="s1">&#39;aeiou&#39;</span><span class="p">])</span>
<span class="n">out</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">has_vowel</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">]))</span>
</pre></div>
</div>

            <li data-component="answer"  id="filter_2_opt_a">(A) A lazy object</li><li data-component="feedback" id="filter_2_opt_a">Applying the list conversion function to map will force completion of the lazy generator object returned by map.</li>
            
            <li data-component="answer"  id="filter_2_opt_b">(B) [True, False, False]</li><li data-component="feedback" id="filter_2_opt_b">This would be the result of map.  Filter will only keep values for which has_vowel is True.</li>
            
            <li data-component="answer" data-correct id="filter_2_opt_c">(C) ['a']</li><li data-component="feedback" id="filter_2_opt_c">Filter will only keep values for which has_vowel is True.</li>
            
            <li data-component="answer"  id="filter_2_opt_d">(D) Error, you can't use a function as an argument for another function.</li><li data-component="feedback" id="filter_2_opt_d">Functions are "first class citizens" in Python, meaning they can be used in the same way as any other piece of data</li>
            

            </ul>
            </div>
<div class="section" id="reduce">
<h2>7.3.3. Reduce<a class="headerlink" href="#reduce" title="Permalink to this headline">¶</a></h2>
<p>The third general operation performed on lists is a reduction, which <strong>reduces</strong>
a list to a value.  Simple reductions can be performed using a list
comprehension in combination with one of Python&#8217;s built-in reducers like
<code class="docutils literal"><span class="pre">sum</span></code>, <code class="docutils literal"><span class="pre">len</span></code>, <code class="docutils literal"><span class="pre">any</span></code>, <code class="docutils literal"><span class="pre">all</span></code>, <code class="docutils literal"><span class="pre">max</span></code> and <code class="docutils literal"><span class="pre">min</span></code>.  For example, we can
count the number of odd values in a list by combining a filter with the <code class="docutils literal"><span class="pre">len</span></code>
reducer function.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [25]: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [26]: </span><span class="n">is_odd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span>

<span class="gp">In [27]: </span><span class="n">num_odd</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">L</span> <span class="k">if</span> <span class="n">is_odd</span><span class="p">(</span><span class="n">x</span><span class="p">)])</span>

<span class="gp">In [28]: </span><span class="n">num_odd</span>
<span class="gh">Out[28]: </span><span class="go">3</span>
</pre></div>
</div>
<p>This action <em>reduced</em> the list to a value, namely the number of odd entries.
Furthermore, this example illustrates how we can combine these basic operations
of map, filter and reduce to complete a task.  In this case we first <em>filter</em>
out the odd values and then <em>reduce</em> that list to the length of the list.</p>
<p>While map and filter are easily represented using list comprehensions, we have
had to rely on Python built-in functions to reduce lists to values.  In general,
we will need to look for a more general solution to these problems and the
standard functional approach is through recursion.</p>
<p>Let&#8217;s look at the imperative solution to a few reduction problems and see if we
can see a pattern.</p>
<p><strong>Problem 1 - Compute the sum of all the numbers in a list</strong></p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [29]: </span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [30]: </span><span class="k">def</span> <span class="nf">sum_list</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="n">acc</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">   ....: </span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
<span class="gp">   ....: </span>        <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span> <span class="o">+</span> <span class="n">item</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span>
<span class="gp">   ....: </span>

<span class="gp">In [31]: </span><span class="n">sum_list</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>
<span class="gh">Out[31]: </span><span class="go">15</span>
</pre></div>
</div>
<p><strong>Problem 2 - Join all the strings in a list into one string</strong></p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [32]: </span><span class="n">my_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>

<span class="gp">In [33]: </span><span class="k">def</span> <span class="nf">join_strings</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="n">acc</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<span class="gp">   ....: </span>        <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span> <span class="o">+</span> <span class="n">item</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span>
<span class="gp">   ....: </span>

<span class="gp">In [34]: </span><span class="n">join_strings</span><span class="p">(</span><span class="n">my_strings</span><span class="p">)</span>
<span class="gh">Out[34]: </span><span class="go">&#39;abc&#39;</span>
</pre></div>
</div>
<p><strong>Problem 3 - Take a list of numbers and return a list of cumulative sums</strong></p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [35]: </span><span class="n">my_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [36]: </span><span class="k">def</span> <span class="nf">cumult_sum</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="n">acc</span> <span class="o">=</span> <span class="p">[</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">   ....: </span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
<span class="gp">   ....: </span>        <span class="n">acc</span> <span class="o">=</span> <span class="n">acc</span> <span class="o">+</span> <span class="p">[</span><span class="n">acc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">item</span><span class="p">]</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span>
<span class="gp">   ....: </span>

<span class="gp">In [37]: </span><span class="n">cumult_sum</span><span class="p">(</span><span class="n">my_numbers</span><span class="p">)</span>
<span class="gh">Out[37]: </span><span class="go">[1, 3, 6, 10, 15]</span>
</pre></div>
</div>
<p>First note that <code class="docutils literal"><span class="pre">join_strings</span></code> uses the first entry in the sequence as the
initial value and iterates over the rest of the sequence.  This approach will be
valid with many reduction problems, and will make a nice default for our initial
value.</p>
<p>Each of the solutions shown above are examples of the accumulator pattern.  In
each case, the variable <code class="docutils literal"><span class="pre">acc</span></code> is set to some initial value and then updated as
we iterate though each value.  Also note how very similar the <em>shape</em> of the
code is in these examples.  A little refactoring will make this very clear.  We
will modify the code in two ways.  First, the initial value will be made a
parameter of each function.  Second, we will define and use a separate function
to update the accumulator.</p>
<p><strong>Problem 1 - Compute the sum of all the numbers in a list</strong></p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [38]: </span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [39]: </span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span> <span class="o">+</span> <span class="n">item</span>
<span class="gp">   ....: </span>

<span class="gp">In [40]: </span><span class="k">def</span> <span class="nf">sum_list</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">init</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="n">acc</span> <span class="o">=</span> <span class="n">init</span>
<span class="gp">   ....: </span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
<span class="gp">   ....: </span>        <span class="n">acc</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span>
<span class="gp">   ....: </span>

<span class="gp">In [41]: </span><span class="n">sum_list</span><span class="p">(</span><span class="n">my_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gh">Out[41]: </span><span class="go">15</span>
</pre></div>
</div>
<p><strong>Problem 2 - Join all the strings in a list into one string</strong></p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [42]: </span><span class="n">my_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>

<span class="gp">In [43]: </span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span> <span class="o">+</span> <span class="n">item</span>
<span class="gp">   ....: </span>

<span class="gp">In [44]: </span><span class="k">def</span> <span class="nf">join_strings</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">init</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="n">acc</span> <span class="o">=</span> <span class="n">init</span>
<span class="gp">   ....: </span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
<span class="gp">   ....: </span>        <span class="n">acc</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span>
<span class="gp">   ....: </span>

<span class="gp">In [45]: </span><span class="n">join_strings</span><span class="p">(</span><span class="n">my_strings</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">my_strings</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gh">Out[45]: </span><span class="go">&#39;abc&#39;</span>
</pre></div>
</div>
<p><strong>Problem 3 - Take a list of numbers and return a list of cumulative sums</strong></p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [46]: </span><span class="n">my_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [47]: </span><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span> <span class="o">+</span> <span class="p">[</span><span class="n">acc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">item</span><span class="p">]</span>
<span class="gp">   ....: </span>

<span class="gp">In [48]: </span><span class="k">def</span> <span class="nf">cumult_sum</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">init</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="n">acc</span> <span class="o">=</span> <span class="n">init</span>
<span class="gp">   ....: </span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
<span class="gp">   ....: </span>        <span class="n">acc</span> <span class="o">=</span> <span class="n">update</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span>
<span class="gp">   ....: </span>

<span class="gp">In [49]: </span><span class="n">cumult_sum</span><span class="p">(</span><span class="n">my_numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">:],[</span><span class="n">my_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="gh">Out[49]: </span><span class="go">[1, 3, 6, 10, 15]</span>
</pre></div>
</div>
<p>These three functions look to be identical, but they are all referencing a
different (globally defined) <code class="docutils literal"><span class="pre">update</span></code> function.  Recall that all Python data
are object, including functions.  The final modification we will make, it adding
a parameter for the update function, allowing us to answer all three problems
with one function.  In Python and LISP, this function is know as <code class="docutils literal"><span class="pre">reduce</span></code>.  In
other languages, such as Haskell, this function is called <code class="docutils literal"><span class="pre">foldl</span></code> for <em>fold
from the left</em>.  In the process of making this last refactor, we will also set
up a default value of init, making sure to iterate through the rest of the list
if using the default.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [50]: </span><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [51]: </span><span class="n">my_strings</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="s2">&quot;c&quot;</span><span class="p">]</span>

<span class="gp">In [52]: </span><span class="n">my_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="gp">In [53]: </span><span class="k">def</span> <span class="nf">reduce</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span><span class="n">init</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">   ....: </span>    <span class="k">if</span> <span class="n">init</span><span class="p">:</span>
<span class="gp">   ....: </span>        <span class="n">acc</span> <span class="o">=</span> <span class="n">init</span>
<span class="gp">   ....: </span>    <span class="k">else</span><span class="p">:</span>
<span class="gp">   ....: </span>        <span class="n">acc</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">   ....: </span>        <span class="n">L</span> <span class="o">=</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="gp">   ....: </span>    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">L</span><span class="p">:</span>
<span class="gp">   ....: </span>        <span class="k">try</span><span class="p">:</span>
<span class="gp">   ....: </span>            <span class="n">acc</span> <span class="o">=</span> <span class="n">function</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="gp">   ....: </span>        <span class="k">except</span><span class="p">:</span>
<span class="gp">   ....: </span>            <span class="k">print</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
<span class="gp">   ....: </span>    <span class="k">return</span> <span class="n">acc</span>
<span class="gp">   ....: </span>

<span class="gp">In [54]: </span><span class="n">list_sum</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">my_list</span><span class="p">)</span>

<span class="gp">In [55]: </span><span class="n">list_sum</span>
<span class="gh">Out[55]: </span><span class="go">15</span>

<span class="gp">In [56]: </span><span class="n">my_str</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">my_strings</span><span class="p">)</span>

<span class="gp">In [57]: </span><span class="n">my_str</span>
<span class="gh">Out[57]: </span><span class="go">&#39;abc&#39;</span>

<span class="gp">In [58]: </span><span class="n">csum</span> <span class="o">=</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">i</span><span class="p">],</span> <span class="n">my_numbers</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="p">[</span><span class="n">my_numbers</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

<span class="gp">In [59]: </span><span class="n">csum</span>
<span class="gh">Out[59]: </span><span class="go">[1, 3, 6, 10, 15]</span>
</pre></div>
</div>
<p>In reality, we didn&#8217;t need to write this function, as it is provided in the
standard <code class="docutils literal"><span class="pre">functools</span></code> library.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [60]: </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>

<span class="gp">In [61]: </span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">i</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
<span class="gh">Out[61]: </span><span class="go">55</span>
</pre></div>
</div>
<p>It will probably take a while to get used to reading a call to reduce.   You
should think of the first argument as the accumulator update function.  The
reduce will keep updating the accumulator as it processes the list.  Let&#8217;s step
through the process item by item to illustrate.</p>
<p>First, to make iterating through <code class="docutils literal"><span class="pre">L</span></code> one item at a time, we construct and
<em>iterator</em> for L using the <code class="docutils literal"><span class="pre">iter</span></code> function called <code class="docutils literal"><span class="pre">iter_L</span></code>.  Then the next
element of <code class="docutils literal"><span class="pre">L</span></code> is acquired by applying <code class="docutils literal"><span class="pre">next</span></code> to <code class="docutils literal"><span class="pre">iter_L</span></code>.  We start by
setting the accumulator <code class="docutils literal"><span class="pre">acc</span></code> to the initial value.  Then <code class="docutils literal"><span class="pre">acc</span></code> is updated
using the current value of the accumulator and the next element in the list.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [62]: </span><span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>

<span class="gp">In [63]: </span><span class="n">iter_L</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

<span class="gp">In [64]: </span><span class="n">init</span> <span class="o">=</span> <span class="mi">0</span>

<span class="gp">In [65]: </span><span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">i</span><span class="o">**</span><span class="mi">2</span>

<span class="gp">In [66]: </span><span class="n">acc</span> <span class="o">=</span> <span class="mi">0</span>

<span class="gp">In [67]: </span><span class="n">current_item</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iter_L</span><span class="p">)</span>

<span class="gp">In [68]: </span><span class="n">current_item</span>
<span class="gh">Out[68]: </span><span class="go">1</span>

<span class="gp">In [69]: </span><span class="n">acc</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">current_item</span><span class="p">)</span>

<span class="gp">In [70]: </span><span class="n">acc</span>
<span class="gh">Out[70]: </span><span class="go">1</span>
</pre></div>
</div>
<p>This process is continued until all of the elements of the list have been
processed (from left to right).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [71]: </span><span class="n">current_item</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iter_L</span><span class="p">)</span>

<span class="gp">In [72]: </span><span class="n">current_item</span>
<span class="gh">Out[72]: </span><span class="go">2</span>

<span class="gp">In [73]: </span><span class="n">acc</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">current_item</span><span class="p">)</span>

<span class="gp">In [74]: </span><span class="n">acc</span>
<span class="gh">Out[74]: </span><span class="go">5</span>

<span class="gp">In [75]: </span><span class="n">current_item</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iter_L</span><span class="p">)</span>

<span class="gp">In [76]: </span><span class="n">current_item</span>
<span class="gh">Out[76]: </span><span class="go">3</span>

<span class="gp">In [77]: </span><span class="n">acc</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">current_item</span><span class="p">)</span>

<span class="gp">In [78]: </span><span class="n">acc</span>
<span class="gh">Out[78]: </span><span class="go">14</span>

<span class="gp">In [79]: </span><span class="n">current_item</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">iter_L</span><span class="p">)</span>

<span class="gp">In [80]: </span><span class="n">current_item</span>
<span class="gh">Out[80]: </span><span class="go">4</span>

<span class="gp">In [81]: </span><span class="n">acc</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">acc</span><span class="p">,</span> <span class="n">current_item</span><span class="p">)</span>

<span class="gp">In [82]: </span><span class="n">acc</span>
<span class="gh">Out[82]: </span><span class="go">30</span>
</pre></div>
</div>
<p>With some practice, you will be able to think about reducing a list to a value
using this high level abstraction (and will (almost) never need to write the
accumulator pattern again!)</p>
<div class="figure">
<img alt="Reducing a list by adding the square of items to the accumulator." src="../_images/reduce_ss_list.png" />
<div class="legend">
When using <code class="docutils literal"><span class="pre">reduce</span></code> with this update function, the square of each item gets
added onto the accumulator <code class="docutils literal"><span class="pre">acc</span></code>.</div>
</div>
<p><code class="docutils literal"><span class="pre">map</span></code>, <code class="docutils literal"><span class="pre">filter</span></code> and <code class="docutils literal"><span class="pre">reduce</span></code> all take functions as arguments.
Consequently, these function are considered <em>higher order functions</em>.  We will
explore higher-order functions in the next section.</p>
<p><strong>Check your understanding</strong></p>

            <ul data-component="multiplechoice" data-multipleanswers="false"  id="reduce_initial_value">
            <p>exceptions-4-13: What will be returned by the following call to <code class="docutils literal"><span class="pre">reduce</span></code>?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>

            <li data-component="answer"  id="reduce_initial_value_opt_a">(A) [2, 3, 4]</li><li data-component="feedback" id="reduce_initial_value_opt_a">You are thinking of map, not reduce.  Reduce takes an initial value and updates this value based on each input.</li>
            
            <li data-component="answer"  id="reduce_initial_value_opt_b">(B) 6</li><li data-component="feedback" id="reduce_initial_value_opt_b">You forgot about the initial value, which in this case was 5.  This reduce will start with the accumulator set to 5, then add 1 to the most current subtotal for each value .</li>
            
            <li data-component="answer"  id="reduce_initial_value_opt_c">(C) 8</li><li data-component="feedback" id="reduce_initial_value_opt_c">We are not adding 1, but the value, to the accumulator.</li>
            
            <li data-component="answer" data-correct id="reduce_initial_value_opt_d">(D) 11</li><li data-component="feedback" id="reduce_initial_value_opt_d">This reduce will start with the accumulator set to 5, then add each value to the most current subtotal for each value.</li>
            

            </ul>
            
            <ul data-component="multiplechoice" data-multipleanswers="false"  id="reduce_add_strings">
            <p>exceptions-4-14: What will be returned by the following call to <code class="docutils literal"><span class="pre">reduce</span></code>?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">])</span>
</pre></div>
</div>

            <li data-component="answer"  id="reduce_add_strings_opt_a">(A) '6'</li><li data-component="feedback" id="reduce_add_strings_opt_a">Adding strings concatenates them!  You need to glue the strings together.</li>
            
            <li data-component="answer" data-correct id="reduce_add_strings_opt_b">(B) '123'</li><li data-component="feedback" id="reduce_add_strings_opt_b">When an initial value isn't provided, reduce will use the first value as the initial value.  This reduce will start with the accumulator set to '1', then add each string to the right side of most current accumulator.</li>
            
            <li data-component="answer"  id="reduce_add_strings_opt_c">(C) 6</li><li data-component="feedback" id="reduce_add_strings_opt_c">Adding strings concatenates them!  You need to glue the strings together.</li>
            
            <li data-component="answer"  id="reduce_add_strings_opt_d">(D) '321'</li><li data-component="feedback" id="reduce_add_strings_opt_d">In this case the item is added to the right of the accumulator, so the strings will accumulate from left to right.</li>
            

            </ul>
            
            <ul data-component="multiplechoice" data-multipleanswers="false"  id="reduce_add_strings_2">
            <p>exceptions-4-15: What will be returned by the following call to <code class="docutils literal"><span class="pre">reduce</span></code>?</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">])</span>
</pre></div>
</div>

            <li data-component="answer"  id="reduce_add_strings_2_opt_a">(A) '6'</li><li data-component="feedback" id="reduce_add_strings_2_opt_a">Adding strings concatenates them!  You need to glue the strings together.</li>
            
            <li data-component="answer"  id="reduce_add_strings_2_opt_b">(B) '123'</li><li data-component="feedback" id="reduce_add_strings_2_opt_b">In this case the item is added to the left of the accumulator, so the strings will accumulate from right to left .</li>
            
            <li data-component="answer"  id="reduce_add_strings_2_opt_c">(C) 6</li><li data-component="feedback" id="reduce_add_strings_2_opt_c">Adding strings concatenates them!  You need to glue the strings together.</li>
            
            <li data-component="answer" data-correct id="reduce_add_strings_2_opt_d">(D) '321'</li><li data-component="feedback" id="reduce_add_strings_2_opt_d">When an initial value isn't provided, reduce will use the first value as the initial value.  This reduce will start with the accumulator set to '1', then add each string to the left side of most current accumulator.</li>
            

            </ul>
            </div>
<div class="section" id="simultaneous-reductions">
<h2>7.3.4. Simultaneous Reductions<a class="headerlink" href="#simultaneous-reductions" title="Permalink to this headline">¶</a></h2>
<p>When computing the average of a sequence, we have been using the following
definition of <code class="docutils literal"><span class="pre">mean</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [83]: </span><span class="n">mean</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<p>Unfortunately, this definition does not work with lazy sequences like those
created by <code class="docutils literal"><span class="pre">map</span></code> and <code class="docutils literal"><span class="pre">filter</span></code>.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [84]: </span><span class="n">mean</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">]))</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-84-645e397552f2&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mean</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">]))</span>

<span class="nn">&lt;ipython-input-83-696eef189864&gt;</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(L)</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mean</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>

<span class="ne">TypeError</span>: object of type &#39;map&#39; has no len()
</pre></div>
</div>
<p>The problem is that a lazy sequence has no idea how long it is and in fact it
may represent an infinite sequence.  A naive attempt to solve this problem might
attempt to replace <code class="docutils literal"><span class="pre">len</span></code> with the corresponding reduction, but this is still
problematic.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [85]: </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>

<span class="gp">In [86]: </span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">add</span>

<span class="gp">In [87]: </span><span class="n">count</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span>

<span class="gp">In [88]: </span><span class="n">mean</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">/</span><span class="nb">reduce</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="gp">In [89]: </span><span class="n">mean</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">]))</span>
<span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ZeroDivisionError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-89-645e397552f2&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mean</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">]))</span>

<span class="nn">&lt;ipython-input-88-a3b42564febf&gt;</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(L)</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">mean</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">L</span><span class="p">)</span><span class="o">/</span><span class="nb">reduce</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="ne">ZeroDivisionError</span>: division by zero
</pre></div>
</div>
<p>Again, the issue stems from the fact that the sequence returned by <code class="docutils literal"><span class="pre">map</span></code> is
lazy, but this time we run into the fact that we can only process this lazy
stream once.  After the sequence passes through <code class="docutils literal"><span class="pre">sum</span></code> it is empty, so the
reduce returns 0.   Luckily in this case we get an exception, if we hadn&#8217;t tried
to divide by 0, we may have missed this subtle bug!</p>
<p>The solution to this issue involves computing <em>both</em> the total and count in one
pass (i.e. in one reduce).  This is accomplished by keeping both accumulators in
a tuple and updating both values at each step.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [90]: </span><span class="kn">from</span> <span class="nn">toolz</span> <span class="kn">import</span> <span class="n">get</span>

<span class="gp">In [91]: </span><span class="n">sum_count</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">L</span><span class="p">:</span> <span class="nb">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span> <span class="n">i</span><span class="p">:</span> <span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">L</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

<span class="gp">In [92]: </span><span class="n">sum_count</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;3&#39;</span><span class="p">]))</span>
<span class="gh">Out[92]: </span><span class="go">(6, 3)</span>
</pre></div>
</div>
<p>We then compose this function with a function that process the tuple of
statistics by dividing the total by the count.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span></span><span class="gp">In [93]: </span><span class="kn">from</span> <span class="nn">toolz</span> <span class="kn">import</span> <span class="n">compose</span><span class="p">,</span> <span class="n">do</span>

<span class="gp">In [94]: </span><span class="n">div_sum_count</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">tup</span><span class="p">:</span> <span class="n">get</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tup</span><span class="p">)</span><span class="o">/</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tup</span><span class="p">)</span>

<span class="gp">In [95]: </span><span class="n">mean</span> <span class="o">=</span> <span class="n">compose</span><span class="p">(</span><span class="n">div_sum_count</span><span class="p">,</span><span class="k">lambda</span> <span class="n">seq</span><span class="p">:</span> <span class="n">do</span><span class="p">(</span><span class="k">print</span><span class="p">,</span> <span class="n">sum_count</span><span class="p">(</span><span class="n">seq</span><span class="p">)))</span>

<span class="gp">In [96]: </span><span class="n">mean</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">]))</span>
<span class="go">(6, 3)</span>
<span class="gh">Out[96]: </span><span class="go">2.0</span>
</pre></div>
</div>
<p>We now have a more general definition of <code class="docutils literal"><span class="pre">mean</span></code>, one that can process both
lists and lazy streams of data.</p>
</div>
</div>


  
      
  <li id="relations-prev" class="navLink" title='Previous Section - 7.1. More Details About Python Functions' data-toggle="tooltip">
    <a href="MoreAboutPythonFunctions.html" >
      <i class='prevNav glyphicon glyphicon-chevron-left'></i>
    </a>
  </li>
  <a class="navLinkBg" id="navLinkBgLeft"  href="MoreAboutPythonFunctions.html" ></a>
  
  <li id="relations-next" class="navLink" title='Next Section - 7.4. What are Higher Order Functions?' data-toggle="tooltip" >
    <a href="WhatAreHigherOrderFunctions.html" >
      <i id="relationsNextIcon" class='nextNav glyphicon glyphicon-chevron-right'></i>
    </a>
  </li>
  <a class="navLinkBg navLink" id="navLinkBgRight" href="WhatAreHigherOrderFunctions.html" >Next Section - 7.4. What are Higher Order Functions?</a>

<script type="text/javascript">

  $('#relations-prev').tooltip({'placement':'right', 'selector': '', 'delay': { show: 100, hide: 50}});
  $('#relations-next').tooltip({'placement':'left', 'selector': '', 'delay': { show: 100, hide: 50}});
  
</script>
  
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      
      | <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2017 Todd Iverson.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.5.
    </p>
  </div>
</footer>



<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-32029811-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



  </body>
</html>